<li class="steam-game-card group {{ post.templatekey }} h-entry hentry">
    <a href="/{{ markata.config.path_prefix }}{{ post.slug }}/"
       class="u-url block p-4 bg-gradient-to-br from-slate-800/90 to-slate-900/90 rounded-xl border border-slate-700 hover:border-blue-500/50 transition-all duration-300 hover:scale-[1.02] hover:shadow-xl hover:shadow-blue-500/10"
       rel="bookmark"
       hx-boost="true"
       aria-label="{{ post.steam.game }} - {{ post.steam.unlocked_achievements }}/{{ post.steam.total_achievements }} achievements unlocked">
        
        <!-- Game Title -->
        <h2 class="p-name entry-title text-lg font-bold mb-3 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-400 line-clamp-2">
            {{ post.steam.game }}
        </h2>
        
        <!-- Game Header Image -->
        <div class="relative mb-3 overflow-hidden rounded-lg bg-slate-800/50">
            <img src="https://cdn.akamai.steamstatic.com/steam/apps/{{ post.steam.app_id }}/header.jpg" 
                 alt="{{ post.steam.game }} header" 
                 loading="lazy"
                 onerror="this.src='https://cdn.akamai.steamstatic.com/steam/apps/{{ post.steam.app_id }}/library_600x900.jpg'"
                 class="w-full h-24 object-cover transition-transform duration-300 group-hover:scale-105">
            <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
        </div>
        
        <!-- Progress Bar -->
        <div class="mb-3">
            <div class="relative w-full h-3 bg-gray-700/50 rounded-full overflow-hidden shadow-inner backdrop-blur-sm border border-gray-600/30">
                <div class="progress-fill-enhanced absolute top-0 left-0 h-full rounded-full shadow-sm flex items-center justify-end pr-1" 
                     style="width: {{ post.steam.completion_percentage or 0 }}%; background: linear-gradient(90deg, #4caf50, #66bb6a, #8bc34a);">
                    {% if (post.steam.completion_percentage or 0) > 5 %}
                    <span class="text-xs font-semibold text-white drop-shadow">{{ "%.0f"|format(post.steam.completion_percentage or 0) }}%</span>
                    {% endif %}
                </div>
            </div>
            <div class="flex justify-between items-center mt-1 text-xs text-gray-400">
                <span class="font-medium">{{ post.steam.unlocked_achievements or 0 }}/{{ post.steam.total_achievements or 0 }}</span>
                <span>{{ "%.1f"|format(post.steam.completion_percentage or 0) }}% Complete</span>
            </div>
        </div>
        
        <!-- Playtime Info -->
        <div class="mb-3 grid grid-cols-2 gap-2 text-xs">
            <div class="text-center p-2 bg-blue-900/30 rounded-lg border border-blue-500/30">
                <p class="text-blue-300 font-semibold">Playtime</p>
                <p class="text-white font-bold">{{ "%.1f"|format(post.steam.playtime_hours or 0) }}h</p>
            </div>
            {% if post.steam.last_played %}
            <div class="text-center p-2 bg-purple-900/30 rounded-lg border border-purple-500/30">
                <p class="text-purple-300 font-semibold">Last Played</p>
                <p class="text-white font-bold text-xs">{{ post.steam.last_played[:7] if post.steam.last_played else 'Never' }}</p>
            </div>
            {% else %}
            <div class="text-center p-2 bg-gray-900/30 rounded-lg border border-gray-600/30">
                <p class="text-gray-400 font-semibold">Last Played</p>
                <p class="text-gray-500 font-bold text-xs">Never</p>
            </div>
            {% endif %}
        </div>
        
        <!-- Achievement Grid - Show All Achievements -->
        {% if (post.steam.total_achievements or 0) > 0 %}
        <div class="mt-3">
            {% set achievements = post.steam.achievements|default([]) %}
            
            {% if achievements|length > 0 %}
                <!-- Full achievement data available -->
                {% set unlocked = achievements|selectattr('achieved', 'equalto', 1)|list %}
                {% set locked = achievements|selectattr('achieved', 'equalto', 0)|list %}
                
                <!-- Achievement Stats -->
                <div class="flex justify-between items-center mb-2 text-xs">
                    <span class="text-green-400">
                        <span class="inline-block w-2 h-2 bg-green-500 rounded-full mr-1"></span>
                        {{ unlocked|length }} unlocked
                    </span>
                    {% if locked|length > 0 %}
                    <span class="text-gray-400">
                        <span class="inline-block w-2 h-2 bg-gray-500 rounded-full mr-1"></span>
                        {{ locked|length }} locked
                    </span>
                    {% endif %}
                </div>
                
                <!-- All Achievements Grid -->
                <div class="achievements-grid">
                    {% for achievement in achievements %}
                    <div class="achievement-item {{ 'unlocked' if achievement.achieved else 'locked' }} relative group/achievement">
                        <div class="achievement-icon-wrapper">
                            <img src="{{ achievement.icon if achievement.achieved else achievement.icongray }}" 
                                 alt="{{ achievement.name }}" 
                                 class="achievement-icon w-full h-full object-cover rounded transition-all duration-300 group-hover/achievement:scale-110"
                                 loading="lazy">
                        </div>
                        <div class="achievement-tooltip">
                            <strong>{{ achievement.name or "Unknown Achievement" }}</strong><br>
                            <small>{{ achievement.description or "No description" }}</small>
                            {% if achievement.achieved %}
                            <br><small class="text-green-400">✓ Unlocked</small>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <!-- Only summary stats available - show placeholder grid -->
                <div class="flex justify-between items-center mb-2 text-xs">
                    <span class="text-green-400">
                        <span class="inline-block w-2 h-2 bg-green-500 rounded-full mr-1"></span>
                        {{ post.steam.unlocked_achievements or 0 }} unlocked
                    </span>
                    {% if ((post.steam.total_achievements or 0) - (post.steam.unlocked_achievements or 0)) > 0 %}
                    <span class="text-gray-400">
                        <span class="inline-block w-2 h-2 bg-gray-500 rounded-full mr-1"></span>
                        {{ (post.steam.total_achievements or 0) - (post.steam.unlocked_achievements or 0) }} locked
                    </span>
                    {% endif %}
                </div>
                
                <!-- Placeholder Grid -->
                <div class="achievements-preview-grid">
                    {% set num_to_show = [6, (post.steam.total_achievements or 0)]|min %}
                    {% for i in range(num_to_show) %}
                    <div class="achievement-item locked">
                        <div class="flex items-center justify-center w-full h-full rounded bg-gray-700/30 border border-gray-600/30">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 text-gray-500">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z" />
                            </svg>
                        </div>
                    </div>
                    {% endfor %}
                    
                    {% if (post.steam.total_achievements or 0) > 6 %}
                    <div class="achievement-item more-indicator">
                        <div class="flex items-center justify-center w-full h-full rounded bg-gray-700/50 text-gray-400 text-xs font-semibold">
                            +{{ (post.steam.total_achievements or 0) - 6 }}
                        </div>
                    </div>
                    {% endif %}
                </div>
            {% endif %}
        </div>
        {% endif %}
        
        <!-- Hover indicator -->
        <div class="mt-3 text-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
            <span class="text-xs text-blue-400 font-medium">View details →</span>
        </div>
    </a>
</li>

<style>
.steam-game-card {
    @apply w-full;
}

.achievements-preview-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 4px;
    max-width: 100%;
}

.achievements-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
    gap: 6px;
    margin: 20px 0;
}

.achievements-grid .achievement-item {
    margin: 0 !important;
}

.achievement-item {
    position: relative;
    cursor: pointer;
    transition: transform 0.2s ease;
    margin: 0 !important;
    padding: 0 !important;
}

.achievement-item:hover {
    transform: scale(1.1);
    z-index: 10;
}

.achievement-icon-wrapper {
    aspect-ratio: 1;
    margin: 0 !important;
    padding: 0 !important;
}

.achievement-icon {
    border: 1px solid #444;
    transition: border-color 0.2s ease;
    width: 100%;
    height: 100%;
    margin: 0 !important;
    padding: 0 !important;
    display: block;
}

.achievement-item.unlocked .achievement-icon {
    border-color: #4caf50;
    box-shadow: 0 0 8px rgba(76, 175, 80, 0.3);
}

.achievement-item.locked .achievement-icon {
    filter: grayscale(100%);
    opacity: 0.6;
}

.achievement-tooltip {
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.95);
    color: white;
    padding: 4px 6px;
    border-radius: 4px;
    font-size: 9px;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
    z-index: 100;
    margin-bottom: 4px;
    max-width: 120px;
    white-space: normal;
    text-align: center;
}

.achievement-item:hover .achievement-tooltip {
    opacity: 1;
}

.more-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
}

.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.progress-fill-enhanced {
    height: 100%;
    border-radius: 12px;
    transition: width 0.5s ease-out;
    position: relative;
    overflow: hidden;
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.2), 0 0 4px rgba(76, 175, 80, 0.3);
}

.progress-fill-enhanced::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    animation: shimmer 3s ease-in-out infinite;
}

@keyframes shimmer {
    0% { transform: translateX(-100%); opacity: 0; }
    50% { opacity: 1; }
    100% { transform: translateX(100%); opacity: 0; }
}

.drop-shadow {
    text-shadow: 0 1px 2px rgba(0,0,0,0.5);
}
</style>